---
title: Prompt Tuning ⚙️
navtitle: Auto templating
layout: page
tags: [post, tuning]
date: 2024-06-13
---

GraphRAG provides the ability to create domain adaptive templates for the generation of the knowledge graph. This step is optional, tho is is highly encouraged to run it as it will yield better results when executing an Index Run.

This templates are generated by loading the inputs, splitting them into chunks and then running a series of LLM invocations and template subtitions to generate the final prompts. It is highly suggested to use the default values the script provides, but in this page you'll find the detail of each in case you want to further explore and tweak the template generation algorithm.

## Usage

You can run the main script from the command line with various options:

```bash
python -m graphrag.prompt_tune [--root ROOT] [--domain DOMAIN]  [--method METHOD] [--limit LIMIT] [--max-tokens MAX_TOKENS] [--chunk-size CHUNK_SIZE] [--no-entity-types] [--output OUTPUT]
```

## Command-Line Options

- --root (optional): The data project root directory, including the config files (YML, JSON, or .env). Defaults to the current directory.

- --domain (optional): The domain related to your input data, such as 'space science', 'microbiology', or 'environmental news'. If left empty, the domain will be inferred from the input data.

- --method (optional): The method to select documents. Options are all, random, or top. Default is random.

- --limit (optional): The limit of files to load when using random or top selection. Default is 15.

- --max-tokens (optional): Maximum token count for prompt generation. Default is set by MAX_TOKEN_COUNT which is 2000.

- --chunk-size (optional): Minimum chunk size for prompt generation. Default is set by MIN_CHUNK_SIZE which is 200.

- --no-entity-types (optional): Use untyped entity extraction generation. When your data is cover a lot of topics or it is highly randomized the guidance is to use untyped entity extraction..

- --output (optional): The folder to save the generated prompts. Default is "prompts".

## Example Usage

```bash
python -m graphrag.prompt_tune --root /path/to/project --domain "environmental news" --method random --limit 10 --max_tokens 2048 --chunk_size 256 --no-entity-types --output /path/to/output
```

or

```bash
python -m graphrag.prompt_tune --root /path/to/project --no-entity-types
```

## Modify Env Vars

After running auto-templating, you should modify the following environment variables (or config variables) to pick up the new prompts on your index run.

- `GRAPHRAG_ENTITY_EXTRACTION_PROMPT_FILE` = "prompts/entity_extraction.txt"

- `GRAPHRAG_COMMUNITY_REPORT_PROMPT_FILE` = "prompts/community_report.txt"

- `GRAPHRAG_SUMMARIZE_DESCRIPTIONS_PROMPT_FILE` = "prompts/summarize_descriptions.txt"
